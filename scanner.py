import hashlib
import requests
from prettytable import PrettyTable
import sys



file=input('Enter location of file:')#Location of the file
BLOCK_SIZE = 65536 # The size of each read from the file

file_hash = hashlib.sha256() # Create the hash object, can use something other than `.sha256()` if you wish
with open(file, 'rb') as f: # Open the file to read it's bytes
    fb = f.read(BLOCK_SIZE) # Read from the file. Take in the amount declared above
    while len(fb) > 0: # While there is still data being read from the file
        file_hash.update(fb) # Update the hash
        fb = f.read(BLOCK_SIZE) # Read the next block from the file

final=file_hash.hexdigest()# Get the hexadecimal digest of the hash
headers={"accept":"application/json","x-apikey":"/* Your VirusTotal api key*/"}
response=requests.get(f'https://www.virustotal.com/api/v3/files/{final}',headers=headers)
stats=response.json()['data']['attributes']['last_analysis_stats']

for key in stats:
    print(key+":"+str(stats[key]))

table=PrettyTable()
table.field_names=["Provider","Category","Result"]
print("Provider\t category\t result")

results=response.json()['data']['attributes']['last_analysis_results']

for key in results:
    table.add_row([key,results[key]['category'],results[key]['result']])

print(table)

